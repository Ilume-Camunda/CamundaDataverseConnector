# Camunda-Dataverse Connector

The Camunda-Dataverse Connector is an integration solution that offers a variety of easily accessable
operations which can be used to create, edit and delete data inside of your Dataverse environments.

For now, it specializes in viewing and customizing table entries. It does this by first requesting an 
access token before using it to send a chosen HTTP request to the Dataverse Web API.

## Table of Contents
- [Prerequisites](#prerequisites)
- [Connector Structure](#connector-structure)
- [Authentification Details](#authentification-details)
- [HTTP Endpoint](#HTTP-endpoint)

## Prerequisites
- A Dataverse environment with a table.
- Access to Microsoft Azure for app creation.
- The authentification details of your Dataverse environment.
- A local (self-managed) Camunda installation or setup of Camunda SaaS.
- A BPMN diagram detailing the process that uses this connector.

## Connector Structure
The connector template contains two major areas that are essential for its functionality:

- Authentification details
- HTTP Endpoint

### Authentification Details
For the connector to be able to send requests to your dataverse environment, it must first receive an access token, 
which is generated by Azure Active Directory through sending a POST request. This request must contain all necessary 
authentification details for it to be successful. The table below shows what these are and where they can be found if 
a proper environment has been set up:

| Name             | Description                                                           | Notes                                                                                                                                                                                                                                                                              |
|------------------|-----------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Base URL         | Your Dynamics URL.                                                    | Go to your Power Apps environment, select the gear icon in the upper right corner and click on advanced settings. This will open your CRM screen where the Dynamics URL will be shown in the upper search bar of your browser.  Usually: `https://{Url of Dynamics 365 Web API}/.` |
| Client ID        | The App ID of the application used inside your Dataverse environment. | Go to your Azure active directory and click on `app registrations`. If an app has not yet been created, do so now. After that your ID will be shown under the label `Application (client) ID`.                                                                                     | 
| Client Secret    | The Client Secret for your created application.                       | Available after creating your app in Microsoft Azure. Click on the label `Client credentials` to reveal all values regarding your secrets. Your client secret is then viewable under `Value`.                                                                                      | 
| Scope            | The level of access that you are requesting.                          | Common scopes include `read`, `write`, `profile`, `email`, etc. Use `default` for a balanced experience.                                                                                                                                                                           | 
| Access Token URL | The URL used to request the access token.                             | The URL is a combination of the Microsoft online URL and the Directory (tenant) ID of your created application in Azure:`https://login.microsoftonline.com/{Directory ID}/oauth2/v2.0/token`                                                                                       | 

### HTTP Endpoint
The area HTTP Endpoint enables you to choose which HTTP request you would like to run and how to customize its output.
The following operations are currently supported and can be chosen under the dropdown menu with the label `Operation`:

- Get all table information
- Get table entry
- Create table entry
- Update table entry
- Delete table entry

To ensure the proper execution of these requests some of the following input fields must be filled out depending on 
which operation is chosen:

| Name             | Description                                                                                                                        | Notes                                                                                                                            |
|------------------|------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------|
| Fields           | Specify through a list of Strings (as a FEEL expression) which fields should be listed inside the returned record of your request. | ex.: `["name", "accountid", "versionnumber"]`                                                                                    |
| Account ID       | Specify which entry you want to address with your request by stating its account ID.                                               | ex.: `d3eb7f1d-f25a-ef11-zfe4-00224876f3fk`                                                                                      | 
| Request Body     | Specify additional data you want to add to your request (as a FEEL expression).                                                    | Example of a body for a PATCH request to update the `name` value of an existing table entry: `{"name":"Updated Sample Account"}` |
